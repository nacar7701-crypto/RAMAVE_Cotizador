<h2>Editar Usuario</h2>

<form id="formEdit">
    <input id="nombre" required />
    <input id="correo" type="email" required />
    <input id="password" type="password" placeholder="Nueva contraseÃ±a (opcional)" />
    <select id="rol">
        <option>Administrador</option>
        <option>Tienda</option>
        <option>Distribuidor</option>
    </select>

    <button class="btn">Guardar</button>
    <button type="button" class="btn" onclick="history.back()">Cancelar</button>
</form>

<script>
const id = @ViewBag.Id;

fetch('/api/usuarios')
    .then(r => r.json())
    .then(data => {
        const u = data.find(x => x.id === id);
        nombre.value = u.nombre;
        correo.value = u.correo_electronico;
        rol.value = u.rol;
    });

formEdit.onsubmit = e => {
    e.preventDefault();
    fetch('/api/usuarios/' + id, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
            id,
            nombre: nombre.value,
            correo_electronico: correo.value,
            password: password.value,
            rol: rol.value
        })
    }).then(() => location.href = '/UsuariosView/Index');
};
</script>
